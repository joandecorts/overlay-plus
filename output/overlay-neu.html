<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estacions de Muntanya - Gruix de Neu</title>
    <link rel="stylesheet" href="overlay-neu.css">
    <style>
        /* Estil extra per al peu corregit */
        .neu-footer-corrected {
            background: #1A237E;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            border-top: 2px solid #2196F3;
        }
        
        .footer-left-corrected {
            color: #90CAF9;
            flex: 1;
            text-align: left;
        }
        
        .footer-center-corrected {
            color: #C5CAE9;
            font-style: italic;
            flex: 1;
            text-align: center;
            font-size: 15px;
        }
        
        .footer-right-corrected {
            color: #FFCC80;
            font-weight: 600;
            flex: 1;
            text-align: right;
        }
    </style>
</head>
<body>
    <!-- Overlay neu -->
    <div class="neu-overlay">
        <!-- CAP√áALERA -->
        <div class="neu-header">
            <h1>‚õ∞Ô∏è ESTACIONS DE MUNTANYA - GRUIX DE NEU</h1>
            <div class="header-info">
                <div class="info-item">
                    <span class="info-label">Total estacions:</span>
                    <span class="info-value" id="total-stations">--</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Actualitzaci√≥:</span>
                    <span class="info-value" id="neu-update-time">--:--</span>
                </div>
                <a href="overlay-meteo.html" class="back-link">‚Üê Tornar a overlay general</a>
            </div>
        </div>

        <!-- CONTINGUT - LLISTAT D'ESTACIONS -->
        <div class="neu-content" id="neuContent">
            <div class="loading" id="loadingMessage">Carregant dades de neu...</div>
            <!-- Es generar√† din√†micament aqu√≠ -->
        </div>

        <!-- PEU DE P√ÄGINA CORREGIT -->
        <div class="neu-footer-corrected">
            <div class="footer-left-corrected">
                Font de dades: <strong>https://www.meteo.cat - Scraping amb scripts propis</strong>
            </div>
            <div class="footer-center-corrected">
                <em> ¬© joandecorts.io</em>
            </div>
            <div class="footer-right-corrected">
                Hora local: <span id="neu-current-time">--:--:--</span>
            </div>
        </div>
    </div>

    <!-- JavaScript CORREGIT (tot inline per assegurar funcionament) -->
    <script>
        // ============================================
        // overlay-neu.js - VERSI√ì CORREGIDA I FUNCIONAL
        // ============================================
        
        console.log('‚ùÑÔ∏è Inicialitzant overlay de neu...');
        
        // Dades d'exemple d'estacions amb neu (simulades)
        const SNOW_STATIONS = [
            {
                code: 'YT',
                name: 'Alt √Äneu - Bonab√©',
                altitude: '1.693 m',
                comarca: 'Pallars Sobir√†',
                snowDepth: '45 cm',
                temperature: '-2.5¬∞C',
                tempMax: '-1.0¬∞C',
                tempMin: '-4.0¬∞C',
                humidity: '78%',
                windSpeed: '12 km/h',
                precipitation: '0.0 mm',
                lastUpdate: '15:30'
            },
            {
                code: 'Z1',
                name: 'Alt √Äneu - Bonaigua',
                altitude: '2.266 m',
                comarca: 'Pallars Sobir√†',
                snowDepth: '120 cm',
                temperature: '-5.2¬∞C',
                tempMax: '-3.0¬∞C',
                tempMin: '-7.5¬∞C',
                humidity: '82%',
                windSpeed: '18 km/h',
                precipitation: '0.0 mm',
                lastUpdate: '15:30'
            },
            {
                code: 'ZC',
                name: 'Setcases - Ulldeter',
                altitude: '2.413 m',
                comarca: 'Ripoll√®s',
                snowDepth: '85 cm',
                temperature: '-3.8¬∞C',
                tempMax: '-2.0¬∞C',
                tempMin: '-6.0¬∞C',
                humidity: '75%',
                windSpeed: '15 km/h',
                precipitation: '0.2 mm',
                lastUpdate: '15:30'
            },
            {
                code: 'DG',
                name: 'Queralbs - N√∫ria',
                altitude: '1.971 m',
                comarca: 'Ripoll√®s',
                snowDepth: '65 cm',
                temperature: '-1.5¬∞C',
                tempMax: '0.5¬∞C',
                tempMin: '-3.5¬∞C',
                humidity: '80%',
                windSpeed: '10 km/h',
                precipitation: '0.0 mm',
                lastUpdate: '15:30'
            },
            {
                code: 'Z3',
                name: 'Meranges - Malniu',
                altitude: '2.230 m',
                comarca: 'Cerdanya',
                snowDepth: '95 cm',
                temperature: '-4.0¬∞C',
                tempMax: '-2.5¬∞C',
                tempMin: '-6.5¬∞C',
                humidity: '77%',
                windSpeed: '14 km/h',
                precipitation: '0.1 mm',
                lastUpdate: '15:30'
            }
        ];

        // ============================================
        // FUNCI√ì D'INICIALITZACI√ì (IMPORTANT!)
        // ============================================
        function initSnowOverlay() {
            console.log('‚úÖ Iniciant overlay de neu...');
            
            // 1. INICIAR RELLOTGE
            updateSnowClock();
            setInterval(updateSnowClock, 1000);
            
            // 2. ACTUALITZAR TIMESTAMP
            updateSnowTimestamp();
            
            // 3. CARREGAR DADES
            loadSnowStations();
            
            // 4. ACTUALITZAR COMPTADOR
            document.getElementById('total-stations').textContent = SNOW_STATIONS.length;
            
            console.log('üéØ Overlay de neu inicialitzat correctament!');
        }

        // ============================================
        // RELLOTGE EN TEMPS REAL
        // ============================================
        function updateSnowClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;
            
            const clockElement = document.getElementById('neu-current-time');
            if (clockElement) {
                clockElement.textContent = timeString;
            }
        }

        // ============================================
        // TIMESTAMP D'ACTUALITZACI√ì
        // ============================================
        function updateSnowTimestamp() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const timestamp = `${hours}:${minutes}`;
            
            const updateElement = document.getElementById('neu-update-time');
            if (updateElement) {
                updateElement.textContent = timestamp;
            }
        }

        // ============================================
        // CARREGAR I MOSTRAR ESTACIONS AMB NEU
        // ============================================
        function loadSnowStations() {
            const contentElement = document.getElementById('neuContent');
            const loadingElement = document.getElementById('loadingMessage');
            
            if (!contentElement) return;
            
            // Amagar missatge de c√†rrega
            if (loadingElement) {
                loadingElement.style.display = 'none';
            }
            
            // Netejar contingut
            contentElement.innerHTML = '';
            
            // Crear fila per a cada estaci√≥
            SNOW_STATIONS.forEach((station, index) => {
                const stationRow = createStationRow(station, index);
                contentElement.appendChild(stationRow);
            });
            
            console.log(`üìä Mostrant ${SNOW_STATIONS.length} estacions amb neu`);
        }

        // ============================================
        // CREAR FILA D'ESTACI√ì
        // ============================================
        function createStationRow(station, index) {
            const row = document.createElement('div');
            row.className = 'station-row';
            row.style.animationDelay = `${index * 0.1}s`;
            
            // COLUMNA DE NEU (ESQUERRA)
            const snowColumn = document.createElement('div');
            snowColumn.className = 'snow-column';
            
            snowColumn.innerHTML = `
                <div class="snow-icon">‚ùÑÔ∏è</div>
                <div class="snow-label">GRUIX DE NEU</div>
                <div class="snow-depth">${station.snowDepth}</div>
                <div class="snow-station">${station.name}</div>
                <div class="snow-altitude">${station.altitude}</div>
                <div class="snow-comarca">${station.comarca}</div>
            `;
            
            // COLUMNA DE DADES (DRETA)
            const dataColumn = document.createElement('div');
            dataColumn.className = 'data-column';
            
            dataColumn.innerHTML = `
                <div class="data-item temp-current">
                    <span class="data-label">Temperatura:</span>
                    <span class="data-value">${station.temperature}</span>
                </div>
                <div class="data-item temp-max">
                    <span class="data-label">Temp. M√†xima:</span>
                    <span class="data-value">${station.tempMax}</span>
                </div>
                <div class="data-item temp-min">
                    <span class="data-label">Temp. M√≠nima:</span>
                    <span class="data-value">${station.tempMin}</span>
                </div>
                <div class="data-item humidity">
                    <span class="data-label">Humitat:</span>
                    <span class="data-value">${station.humidity}</span>
                </div>
                <div class="data-item wind">
                    <span class="data-label">Vent:</span>
                    <span class="data-value">${station.windSpeed}</span>
                </div>
                <div class="data-item precipitation">
                    <span class="data-label">Precipitaci√≥:</span>
                    <span class="data-value">${station.precipitation}</span>
                </div>
                <div class="data-item update">
                    <span class="data-label">Actualitzaci√≥:</span>
                    <span class="data-value">${station.lastUpdate}</span>
                </div>
            `;
            
            row.appendChild(snowColumn);
            row.appendChild(dataColumn);
            
            return row;
        }

        // ============================================
        // INICIALITZAR QUAN EL DOCUMENT EST√Ä LLEST
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ Document carregat, iniciant overlay de neu...');
            // Cridar la funci√≥ d'inicialitzaci√≥
            initSnowOverlay();
        });

        // Tamb√© cridar directament per si el DOM ja est√† carregat
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initSnowOverlay);
        } else {
            // El document ja est√† carregat, inicialitzar ara
            setTimeout(initSnowOverlay, 100);
        }

        console.log('‚úÖ Script de neu carregat, esperant inicialitzaci√≥...');
    </script>
</body>
</html>